/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.0 		*/
/*  Created On : 28-nov.-2022 17:26:29 				*/
/*  DBMS       : SQL Server 2012 						*/
/* ---------------------------------------------------- */

/* Drop Foreign Key Constraints */

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Bodega_Tienda]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Bodega] DROP CONSTRAINT [FK_Bodega_Tienda]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Cliente_Tienda]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Cliente] DROP CONSTRAINT [FK_Cliente_Tienda]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Inventario_Bodega]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Inventario] DROP CONSTRAINT [FK_Inventario_Bodega]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Inventario_Producto]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Inventario] DROP CONSTRAINT [FK_Inventario_Producto]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Producto_Tipoproducto]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Producto] DROP CONSTRAINT [FK_Producto_Tipoproducto]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Proveedor_Tienda]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Proveedor] DROP CONSTRAINT [FK_Proveedor_Tienda]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[FK_Usuario_Rol]') AND OBJECTPROPERTY(id, N'IsForeignKey') = 1) 
ALTER TABLE [Usuario] DROP CONSTRAINT [FK_Usuario_Rol]
GO

/* Drop Tables */

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Bodega]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Bodega]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Cliente]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Cliente]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Inventario]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Inventario]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Producto]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Producto]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Proveedor]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Proveedor]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Rol]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Rol]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Tienda]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Tienda]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Tipoproducto]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Tipoproducto]
GO

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(N'[Usuario]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
DROP TABLE [Usuario]
GO

/* Create Tables */

CREATE TABLE [Bodega]
(
	[BodegaID] int NOT NULL IDENTITY (1, 1),
	[TiendaID] int NOT NULL,
	[Nombre] nvarchar(50) NOT NULL,
	[No_documento] nvarchar(20) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1 
)
GO

CREATE TABLE [Cliente]
(
	[ClienteID] int NOT NULL IDENTITY (1, 1),
	[TiendaID] int NOT NULL,
	[Nombre] nvarchar(50) NOT NULL,
	[Cedula] nvarchar(30) NOT NULL,
	[Numero_telefonico] nvarchar(20) NOT NULL,
	[Email] nvarchar(30) NOT NULL,
	[Direccion] nvarchar(200) NOT NULL,
	[Sexo] int NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Inventario]
(
	[InventarioID] int NOT NULL IDENTITY (1, 1),
	[BodegaID] int NOT NULL,
	[ProductoID] int NOT NULL,
	[Cant_inicial] int NOT NULL,
	[Movimiento_pos] int NOT NULL,
	[Movimiento_neg] int NOT NULL,
	[Saldo_final] int NOT NULL,
	[Fecha] date NOT NULL,	-- o
	[estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Producto]
(
	[ProductoID] int NOT NULL IDENTITY (1, 1),
	[TipoproductoID] int NOT NULL,
	[Nombre] nvarchar(50) NOT NULL,
	[Descripcion] nvarchar(200) NOT NULL,
	[Precio] decimal(18,2) NOT NULL,
	[Marca] nvarchar(20) NOT NULL,
	[Fecha_ingreso] date NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Proveedor]
(
	[ProveedorID] int NOT NULL IDENTITY (1, 1),
	[TiendaID] int NOT NULL,
	[Nombre] nvarchar(50) NOT NULL,
	[Telefono] nvarchar(20) NOT NULL,
	[Cedula] nvarchar(30) NOT NULL,
	[Email] nvarchar(30) NOT NULL,
	[Direccion] nvarchar(200) NOT NULL,
	[Sexo] int NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Rol]
(
	[RolID] int NOT NULL IDENTITY (1, 1),
	[Rol_name] nvarchar(15) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Tienda]
(
	[TiendaID] int NOT NULL IDENTITY (1, 1),
	[Nombre] nvarchar(50) NOT NULL,
	[Telefono] nvarchar(20) NOT NULL,
	[Email] nvarchar(30) NOT NULL,
	[Direccion] nvarchar(200) NOT NULL,
	[Ruc] nvarchar(20) NOT NULL,
	[Hora_abierto] nvarchar(7) NOT NULL,
	[Hora_cerrado] nvarchar(7) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Tipoproducto]
(
	[TipoproductoID] int NOT NULL IDENTITY (1, 1),
	[Nombre] nvarchar(50) NOT NULL,
	[Descripcion] nvarchar(200) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

CREATE TABLE [Usuario]
(
	[UsuarioID] int NOT NULL IDENTITY (1, 1),
	[RolID] int NOT NULL,
	[Username] nvarchar(15) NOT NULL,
	[Clave] nvarchar(15) NOT NULL,
	[Estado] int NOT NULL DEFAULT 1
)
GO

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE [Bodega] 
 ADD CONSTRAINT [PK_Bodega]
	PRIMARY KEY CLUSTERED ([BodegaID] ASC)
GO

ALTER TABLE [Cliente] 
 ADD CONSTRAINT [PK_Cliente]
	PRIMARY KEY CLUSTERED ([ClienteID] ASC)
GO

ALTER TABLE [Inventario] 
 ADD CONSTRAINT [PK_Inventario]
	PRIMARY KEY CLUSTERED ([InventarioID] ASC)
GO

ALTER TABLE [Producto] 
 ADD CONSTRAINT [PK_Producto]
	PRIMARY KEY CLUSTERED ([ProductoID] ASC)
GO

ALTER TABLE [Proveedor] 
 ADD CONSTRAINT [PK_Proveedor]
	PRIMARY KEY CLUSTERED ([ProveedorID] ASC)
GO

ALTER TABLE [Rol] 
 ADD CONSTRAINT [PK_Rol]
	PRIMARY KEY CLUSTERED ([RolID] ASC)
GO

ALTER TABLE [Tienda] 
 ADD CONSTRAINT [PK_Tienda]
	PRIMARY KEY CLUSTERED ([TiendaID] ASC)
GO

ALTER TABLE [Tipoproducto] 
 ADD CONSTRAINT [PK_Tipoproducto]
	PRIMARY KEY CLUSTERED ([TipoproductoID] ASC)
GO

ALTER TABLE [Usuario] 
 ADD CONSTRAINT [PK_Usuario]
	PRIMARY KEY CLUSTERED ([UsuarioID] ASC)
GO

/* Create Foreign Key Constraints */

ALTER TABLE [Bodega] ADD CONSTRAINT [FK_Bodega_Tienda]
	FOREIGN KEY ([TiendaID]) REFERENCES [Tienda] ([TiendaID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Cliente] ADD CONSTRAINT [FK_Cliente_Tienda]
	FOREIGN KEY ([TiendaID]) REFERENCES [Tienda] ([TiendaID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Inventario] ADD CONSTRAINT [FK_Inventario_Bodega]
	FOREIGN KEY ([BodegaID]) REFERENCES [Bodega] ([BodegaID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Inventario] ADD CONSTRAINT [FK_Inventario_Producto]
	FOREIGN KEY ([ProductoID]) REFERENCES [Producto] ([ProductoID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Producto] ADD CONSTRAINT [FK_Producto_Tipoproducto]
	FOREIGN KEY ([TipoproductoID]) REFERENCES [Tipoproducto] ([TipoproductoID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Proveedor] ADD CONSTRAINT [FK_Proveedor_Tienda]
	FOREIGN KEY ([TiendaID]) REFERENCES [Tienda] ([TiendaID]) ON DELETE No Action ON UPDATE No Action
GO

ALTER TABLE [Usuario] ADD CONSTRAINT [FK_Usuario_Rol]
	FOREIGN KEY ([RolID]) REFERENCES [Rol] ([RolID]) ON DELETE No Action ON UPDATE No Action
GO

/* Create Table Comments */

EXEC sp_addextendedproperty 'MS_Description', 'o', 'Schema', [dbo], 'table', [Inventario], 'column', [Fecha]
GO
